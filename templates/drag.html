<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>拖牌分析</title>
	<style>
		body { font-family: Arial, sans-serif; padding: 1rem; }
		table { border-collapse: collapse; width: 100%; }
		th, td { border: 1px solid #ddd; padding: 6px 8px; text-align: center; }
		th { background:#f2f2f2; }
		section { margin-bottom: 1.5rem; }
	</style>
</head>
<body>
	<nav style="margin-bottom:0.5rem;">
		<a href="/">主頁</a> |
		<a href="/drag">拖牌</a>|
		<a href="/sumation">和數</a>

	</nav>
	<hr>
	<h2>拖牌分析</h2>
	<hr>
    <form method="get" action="{{ url_for('stats') }}" style="margin-bottom:1rem;">
        <label for="period">選擇上幾期做定位牌:</label>
        <select id="period" name="period" onchange="this.form.submit()">
            {% for p in range(1, 5) %}
                <option value="{{ p }}" {% if p == period %}selected{% endif %}>{{ p }}</option>
            {% endfor %}
        </select>
		&nbsp;&nbsp;
		<label for="total_data_num">資料筆數:</label>
		<select id="total_data_num" name="total_data_num" onchange="this.form.submit()">
			{% set cur_total = total_data_num|default('100') %}
			{% for t in [100,200,300,400,500,1000,1500,2000,2500,3000] %}
				<option value="{{ t }}" {% if (t|string) == (cur_total|string) %}selected{% endif %}>{{ t }}</option>
			{% endfor %}
		</select>
        <noscript><button type="submit">Apply</button></noscript>
    </form>
	<h2>定位牌</h2>
	<p>{{ locator_array }}</p>


    <!-- period selector form -->


	<h2>分析</h2>
	{% if drag_results %}
		{% for r in drag_results %}
			<section>
				<h3>號碼[{{ locator_array[r.idx] }}]拖===></h3>
				<!-- horizontal table showing numbers 1..39 as headers and counts in a single row -->
				<div style="overflow-x:auto;">
					<table style="max-width:1200px; min-width:900px;">
						<thead>
							<tr><th>號碼</th>
								{% for num, cnt in r.sorted_counts %}
									<th>{{ num }}</th>
								{% endfor %}
							</tr>
						</thead>
						<tbody>
							<tr><th>次數</th>
								{% for num, cnt in r.sorted_counts %}
									<td>{{ cnt }}</td>
								{% endfor %}
							</tr>
						</tbody>
					</table>
				</div>
			</section>
		{% endfor %}
	{% else %}
		<p>No drag results to display.</p>
	{% endif %}

</body>
</html>
